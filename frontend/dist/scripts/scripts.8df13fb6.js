"use strict";angular.module("cgeUploaderApp",["ngAnimate","ngCookies","ngMessages","ngResource","ngRoute","ngSanitize","ngTouch","ngFileUpload","ui.bootstrap","ui.grid","ui.grid.resizeColumns","ui.grid.autoResize","cgeUploaderApp.config"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/kmerfinder.html",controller:"KmerFinderCtrl",controllerAs:"kmerfinder"}).otherwise({redirectTo:"/"})}]),angular.module("cgeUploaderApp").controller("KmerFinderCtrl",["$scope","API","$http",function(a,b){console.log(b),a.isolateFiles=[],a.matches=!1,a.error=!1,a.message={text:"",status:0},a.$on("newFile",function(c,d){console.log(c);var e=new kmerModule.KmerFinderClient(d,"browser","ATGAC",16,1,1,!0,"server",b.url+"kmers","","KmerBacteria","Kmers");a.fileProgress=e.lines,console.log(e),console.log("reading!");var f=e.findKmers();f.event.on("progress",function(b){d.kmerSize=e.kmerMap.size,d.dataRead=100*b.transferred/d.size,a.$apply()}),f.promise.then(function(a){return console.log("Assigning kmers!"),d.kmers=a,console.log("Let's find some matches! "),e.findFirstMatch(a)}).then(function(b){function c(e){(b=e.next()).done||(d.matchesGrid.data.push(b.value),a.$apply(),setTimeout(function(){c(e)},10))}console.log("Winner found!"),d.species=b.species,d.match=!0,e.progress=!1;var f=e.findMatches(b,d.kmers);c(f)})["catch"](function(b){console.log("ERROR!!",b),a.message.text=b,a.message.status=2,a.$apply()})})}]),angular.module("cgeUploaderApp").directive("dropFilesButton",function(){return{templateUrl:"templates/dropFilesButton.html",restrict:"E",link:function(a,b,c){console.log(a,b,c,a.isolateFiles),a.tabs=a.$parent.tabs,a.filesValid=!1,a.isService=c.isService,a.validate=function(b){return console.log(a.isolateFiles,b),b.match=!1,b.species="",b.firstTime=b.firstTime?!1:!0,b.matchesGrid={showGridFooter:!0,enableSorting:!0,cellEditableCondition:!0,onRegisterApi:function(a){console.log(a),b.gridApi=a},columnDefs:[{field:"species",width:"50%"},{field:"template",width:"20%"},{field:"score",width:"10%"},{field:"expected",width:"10%"},{field:"z",width:"10%"},{field:"probability",width:"10%"},{field:"frac-q",width:"12%"},{field:"frac-d",width:"12%"},{field:"depth",width:"10%"},{field:"kmers-template",width:"10%"},{field:"total-frac-d",width:"10%"},{field:"total-frac-q",width:"10%"},{field:"total-temp-cover",width:"10%"}],data:[]},b.status={isFirstOpen:!0,isFirstDisabled:!1},console.log(b.firstTime),b.firstTime&&a.$broadcast("newFile",b),!0}}}}),angular.module("cgeUploaderApp").run(["$templateCache",function(a){a.put("views/kmerfinder.html",'<div ng-controller="KmerFinderCtrl"> <div class="jumbotron"> <h1 class="text-center"> <span style="color: #3f51b5">KmerFinder</span> <span style="color: #ff5722">JS</span> </h1> <!-- <p>...</p>\n        <p><a class="btn btn-primary btn-lg" href="#" role="button">Learn more</a></p> --> </div> <drop-files-button active="true" is-service="true"></drop-files-button> <div ng-show="isolateFiles.length !== 0" class="well well-lg"> <div class="row"> <div class="col-xs-6"> <!-- <button id="submitButton" ng-click="analize()" type="button" class="text-center btn btn-material-indigo-500 btn-lg">\n                    Predict Species\n                </button> --> </div> <div class="col-xs-6"> <p ng-show="message.status !== 0" class="text-center" ng-class="{\n                      \'alert alert-danger\': message.status === 2,\n                      \'alert alert-info\': message.status === 1,\n                      \'alert alert-success\': message.status === 3}"> {{message.text}} </p> </div> </div> <div ng-repeat="f in isolateFiles"> <div class="text-center" ng-show="f.dataRead"> Reading <strong ng-class="{parsing: f.dataRead < 100, parsed: f.dataRead >= 100}"> {{f.name}} </strong> <div>({{f.kmerSize}} kmers)</div> <div class="progress"> <div class="progress-bar" style="width: {{f.dataRead}}%"></div> <span class="sr-only">{{f.dataRead}}%</span> </div> </div> <h3 ng-show="f.match" class="text-center"> <span style="color: #ff5722">{{f.species}}</span> </h3> <div ng-show="f.match" ui-grid="f.matchesGrid" class="myGrid" ui-grid-auto-resize ui-grid-resize-columns></div> </div> </div> </div>')}]);