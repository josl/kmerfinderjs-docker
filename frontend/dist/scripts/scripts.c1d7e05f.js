"use strict";angular.module("cgeUploaderApp",["ngAnimate","ngCookies","ngMessages","ngResource","ngRoute","ngSanitize","ngTouch","ngFileUpload","ui.bootstrap","ui.grid","ui.grid.resizeColumns","ui.grid.autoResize","cgeUploaderApp.config"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/kmerfinder.html",controller:"KmerFinderCtrl",controllerAs:"kmerfinder"}).otherwise({redirectTo:"/"})}]),angular.module("cgeUploaderApp").controller("KmerFinderCtrl",["$scope","API","$http",function(a,b,c){console.log(b),a.isolateFiles=[],a.matches=!1,a.error=!1,a.message={text:"",status:0},a.analize=function(){console.log(a.isolateFiles),a.isolateFiles&&a.isolateFiles.length&&angular.forEach(a.isolateFiles,function(c){console.log(c);var d=new kmerModule.KmerFinderClient(c,"browser","ATGAC",16,1,1,!0,"server",b.url+"","","KmerBacteria","Kmers");a.fileProgress=d.lines,console.log(d);var e=d.findKmers();e.event.on("progress",function(){c.lines=d.lines,c.kmers=d.kmerMap.size,c.dataRead=100*d.fileDataRead/c.size,a.$apply()}),e.promise.then(function(b){console.log("Let's find some matches! ");var e=d.findMatches(b);return e.event.on("queryReceived",function(){a.message.text="Query recevied! Calculating matches...",a.message.status=1,console.log("queryReceived"),a.$apply()}),e.event.on("newMatch",function(b){console.log("newMatch"),0===c.matchesGrid.data.length&&(c.species=b.species,c.match=!0),c.matchesGrid.data.push(b),a.$apply()}),e.promise}).then(function(b){console.log("We are done here!!",b),a.message.text="All matches recevied!",a.message.status=3,a.$apply()})["catch"](function(b){console.log("ERROR!!",b),a.message.text=b,a.message.status=2,a.$apply()})})}}]),angular.module("cgeUploaderApp").directive("dropFilesButton",function(){return{templateUrl:"templates/dropFilesButton.html",restrict:"E",link:function(a,b,c){a.tabs=a.$parent.tabs,a.filesValid=!1,a.isService=c.isService,a.validate=function(b){return console.log(a.isolateFiles,b),b.match=!1,b.species="",b.matchesGrid={showGridFooter:!0,enableSorting:!0,cellEditableCondition:!0,columnDefs:[{field:"species",width:"50%"},{field:"template",width:"20%"},{field:"score",width:"10%"},{field:"expected",width:"10%"},{field:"z",width:"15%"},{field:"probability",width:"10%"},{field:"frac-q",width:"15%"},{field:"frac-d",width:"15%"},{field:"depth",width:"18%"},{field:"kmers-template",width:"10%"},{field:"total-frac-d",width:"10%"},{field:"total-frac-q",width:"10%"},{field:"total-temp-cover",width:"10%"}],data:[]},b.status={isFirstOpen:!0,isFirstDisabled:!1},!0}}}}),angular.module("cgeUploaderApp").run(["$templateCache",function(a){a.put("views/kmerfinder.html",'<div ng-controller="KmerFinderCtrl"> <div class="jumbotron"> <h1 class="text-center"> <span style="color: #3f51b5">KmerFinder</span> <span style="color: #ff5722">JS</span> </h1> <!-- <p>...</p>\n        <p><a class="btn btn-primary btn-lg" href="#" role="button">Learn more</a></p> --> </div> <drop-files-button active="true" is-service="true"></drop-files-button> <!-- <div class="alert alert-danger text-center" role="alert" ng-show="error">\n        <h4>\n            {{errorMessage}}\n        </h4>\n    </div> --> <div ng-show="isolateFiles.length !== 0" class="well well-lg"> <div class="row"> <div class="col-xs-6"> <button id="submitButton" ng-click="analize()" type="button" class="text-center btn btn-material-indigo-500 btn-lg"> Predict Species </button> </div> <div class="col-xs-6"> <p ng-show="message.status !== 0" class="text-center" ng-class="{\n                      \'alert alert-danger\': message.status === 2,\n                      \'alert alert-info\': message.status === 1,\n                      \'alert alert-success\': message.status === 3}"> {{message.text}} </p> </div> </div> <div ng-repeat="f in isolateFiles"> <div class="text-center" ng-show="f.lines"> Reading <strong ng-class="{parsing: f.dataRead < 100, parsed: f.dataRead >= 100}"> {{f.name}} </strong> <div>({{f.lines}} lines / {{f.kmers}} kmers)</div> <div class="progress"> <div class="progress-bar" style="width: {{f.dataRead}}%"></div> </div> </div> <h3 ng-show="f.match" class="text-center"> <span style="color: #ff5722">{{f.species}}</span> </h3> <div ng-show="f.match" ui-grid="f.matchesGrid" class="myGrid" ui-grid-auto-resize></div> <!-- <uib-accordion>\n                <uib-accordion-group is-open="f.status">\n                    <uib-accordion-heading>\n                        I can have markup, too!\n                        <i class="pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\': f.status.open, \'glyphicon-chevron-right\': !f.status.open}"></i>\n                    </uib-accordion-heading>\n                    This is just some content to illustrate fancy headings.\n                </uib-accordion-group>\n            </uib-accordion> --> </div> </div> </div>')}]);